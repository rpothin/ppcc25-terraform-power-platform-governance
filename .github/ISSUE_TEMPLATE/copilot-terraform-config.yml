name: ðŸš€ New Terraform Configuration
description: Request initialization of a new Terraform configuration following AVM specifications and repository standards
title: "[TERRAFORM] Initialize new configuration: "
labels: ["terraform", "new-configuration"]
projects: []
assignees: []
body:
  - type: markdown
    attributes:
      value: |
        ## ðŸŽ¯ Terraform Configuration Initialization Request
        
        This form creates a task for GitHub Copilot to initialize a new Terraform configuration following Azure Verified Modules (AVM) specifications and repository standards.
        
        **ðŸ“‹ Required Instructions:**
        - **Baseline Standards**: Follow [baseline.instructions.md](/.github/instructions/baseline.instructions.md)
        - **Terraform Standards**: Follow [terraform-iac.instructions.md](/.github/instructions/terraform-iac.instructions.md)
        - **Initialization Process**: Follow [init-terraform-configuration.prompt.md](/.github/prompts/init-terraform-configuration.prompt.md)
        
        **âš ï¸ Important:** All generated code must pass `terraform fmt -check` and `terraform validate` before completion.

  - type: dropdown
    id: classification
    attributes:
      label: AVM Module Classification
      description: Select the type of Terraform configuration to create
      options:
        - "res-* (Resource Module) - Deploy primary Power Platform resources"
        - "ptn-* (Pattern Module) - Deploy multiple resources using composable patterns"
        - "utl-* (Utility Module) - Provide reusable data sources without deploying resources"
    validations:
      required: true

  - type: input
    id: configuration_name
    attributes:
      label: Configuration Name
      description: Technical name following convention (e.g., res-dlp-policy, utl-export-connectors)
      placeholder: "res-dlp-policy"
    validations:
      required: true

  - type: textarea
    id: primary_purpose
    attributes:
      label: Primary Purpose
      description: Brief description of what this configuration will accomplish
      placeholder: "Creates and manages Data Loss Prevention policies for Power Platform environments with comprehensive connector classification and business rule enforcement."
    validations:
      required: true

  - type: checkboxes
    id: environment_support
    attributes:
      label: Environment Support
      description: Select if multi-environment support is needed
      options:
        - label: Multi-environment support (creates tfvars/ directory with an example file)
          required: false

  - type: textarea
    id: reference_materials
    attributes:
      label: Reference Materials and Documentation
      description: |
        Provide links to official documentation, existing examples, or other reference materials
        that Copilot should use for context and implementation guidance.
      placeholder: |
        - Official Power Platform DLP documentation
        - Microsoft Learn modules for governance
        - Existing configuration examples in repository
        - Azure Verified Modules standards for similar resources
    validations:
      required: true
      
  - type: markdown
    attributes:
      value: |
        ## ðŸŽ¯ Success Criteria for Terraform Configuration Initialization
        
        **The following validation requirements serve as success criteria for this task:**
        
        ### âœ… **Format & Syntax Validation**
        - Configuration must pass `terraform fmt -check` validation (proper HCL formatting)
        - Configuration must pass `terraform validate` syntax check (valid Terraform syntax)
        
        ### âœ… **Test Coverage Requirements** 
        - **`utl-*` modules**: Minimum 15+ test assertions (plan tests only)
        - **`res-*` modules**: Minimum 20+ test assertions (both plan and apply tests)
        - **`ptn-*` modules**: Minimum 25+ test assertions (both plan and apply tests)
        
        ### âœ… **AVM Compliance Standards**
        - Follow Azure Verified Modules (AVM) specifications and repository standards
        - Implement anti-corruption layer pattern for outputs
        - Use explicit variable typing (no `any` types) with comprehensive validation
        - Include lifecycle management for resource modules (`ignore_changes`)
        - Use centralized provider version (`~> 3.8` for `microsoft/power-platform`)
        
        ### âœ… **Documentation & Structure**
        - Auto-generated README.md via terraform-docs
        - Comprehensive inline comments explaining architectural decisions
        - Template-based initialization following placeholder replacement process
        - CHANGELOG.md entry for new configuration
